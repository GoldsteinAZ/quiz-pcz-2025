<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Aplikacje WWW - Nauka</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #e0e0e0;
            background: #2a2a2a;
            min-height: 100vh;
            padding: 20px;
        }        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #3a3a3a;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            padding: 30px;
        }        h1 {
            text-align: center;
            color: #d0d0d0;
            margin-bottom: 30px;
            font-size: 2.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }        .question-container {
            background: #4a4a4a;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .question-container:hover {
            border: 2px solid #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.2);
            /* Uwypuklenie konteneara z pytaniem */
            transform: translateY(0px); 
            background: #525252;
        }        .question-container.correct-answer {
            border: 3px solid #48bb78 !important;
        }

        .question-container.incorrect-answer {
            border: 3px solid #e53e3e !important;
        }

        .question-number {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #e0e0e0;
        }        .show-answer-btn {
            background: linear-gradient(45deg, #4a9d63, #3d8555);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 157, 99, 0.3);
        }        .show-answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 157, 99, 0.4);
        }

        .show-all-answers-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            display: block;
            margin-left: auto;
            margin-right: auto;
        }        .show-all-answers-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .study-mode-btn {
            background: linear-gradient(45deg, #ed8936, #dd6b20);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 30px;
            margin-left: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(237, 137, 54, 0.3);
            display: inline-block;
        }

        .study-mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(237, 137, 54, 0.4);
        }        .buttons-container {
            text-align: center;
            margin-bottom: 30px;
        }        .database-selector {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: #4a4a4a;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .database-selector label {
            display: block;
            font-weight: 600;
            color: #d0d0d0;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .database-selector select {
            background: #3a3a3a;
            border: 2px solid #666666;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 1rem;
            color: #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 300px;
        }

        .database-selector select:hover {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }        .database-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .order-buttons-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .order-btn {
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 0 10px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .order-btn.original-order {
            background: linear-gradient(45deg, #38b2ac, #319795);
            box-shadow: 0 4px 15px rgba(56, 178, 172, 0.3);
        }

        .order-btn.original-order:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 178, 172, 0.4);
        }

        .order-btn.shuffle-order {
            background: linear-gradient(45deg, #9f7aea, #805ad5);
            box-shadow: 0 4px 15px rgba(159, 122, 234, 0.3);
        }

        .order-btn.shuffle-order:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(159, 122, 234, 0.4);
        }

        .order-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .show-answer-btn.hidden {
            display: none;
        }        .option.hidden {
            display: none;
        }

        .floating-buttons {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }        .floating-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1;
        }

        .floating-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }        .floating-btn.study-mode {
            background: linear-gradient(45deg, #ed8936, #dd6b20);
            box-shadow: 0 4px 15px rgba(237, 137, 54, 0.3);
        }

        .floating-btn.study-mode:hover {
            box-shadow: 0 6px 20px rgba(237, 137, 54, 0.4);
        }        .floating-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }        .progress-counter {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1;
            margin-bottom: 10px;
            align-self: center;
        }

        .progress-counter:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
        }

        .theme-toggle-btn {
            background: linear-gradient(45deg, #4a5568, #2d3748);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin-left: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 85, 104, 0.3);
            display: inline-block;
        }        .theme-toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 85, 104, 0.4);
        }        .check-answers-btn {
            background: linear-gradient(45deg, #e53e3e, #c53030);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(229, 62, 62, 0.3);
        }

        .check-answers-btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(229, 62, 62, 0.4);
        }

        .check-answers-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }        .quiz-buttons-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0 10px 0;
        }        .results-container {
            background: #4a4a4a;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0 25px 0;
            border-left: 5px solid #667eea;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .results-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 12px;
        }

        .results-score {
            font-size: 2rem;
            font-weight: 800;
            margin: 12px 0;
        }

        .results-score.excellent {
            color: #48bb78;
        }

        .results-score.good {
            color: #ed8936;
        }

        .results-score.poor {
            color: #e53e3e;
        }

        .results-details {
            font-size: 1rem;
            font-weight: 600;
            color: #d0d0d0;
            margin-bottom: 8px;
        }

        .results-percentage {
            font-size: 0.95rem;
            color: #a0a0a0;
            font-weight: 500;
        }        .restart-answers-btn {
            background: linear-gradient(45deg, #ed8936, #dd6b20);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(237, 137, 54, 0.3);
        }

        .restart-answers-btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(237, 137, 54, 0.4);
        }

        .restart-answers-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Light theme styles */
        body.light-theme {
            color: #000000;
            background: #667eea;
        }

        body.light-theme .container {
            background: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        body.light-theme h1 {
            color: #4a5568;
        }

        body.light-theme .question-container {
            background: #f8f9fa;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        body.light-theme .question-container:hover {
            background: #f0f4ff;
        }

        body.light-theme .question-text {
            color: #2d3748;
        }

        body.light-theme .database-selector {
            background: #f8f9fa;
        }

        body.light-theme .database-selector label {
            color: #4a5568;
        }

        body.light-theme .database-selector select {
            background: white;
            border: 2px solid #e2e8f0;
            color: #2d3748;
        }

        body.light-theme .option {
            background: white;
            border: 2px solid #e2e8f0;
        }

        body.light-theme .option:hover {
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
        }        body.light-theme .option.correct {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: #000000;
            border-color: #38a169;
            font-weight: 600;
        }

        body.light-theme .option.incorrect {
            background: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        body.light-theme .option.selected {
            background: #e6f3ff;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3);
        }        body.light-theme .option.correct .option-letter {
            background: #38a169;
            color: white;
        }

        body.light-theme .option.incorrect .option-letter {
            background: #e53e3e;
            color: white;
        }

        body.light-theme .error {
            background: #fed7d7;
            color: #742a2a;
        }

        body.light-theme .check-answers-btn {
            box-shadow: 0 4px 15px rgba(229, 62, 62, 0.2);
        }

        body.light-theme .results-container {
            background: #f8f9fa;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        body.light-theme .results-title {
            color: #667eea;
        }

        body.light-theme .results-details {
            color: #4a5568;
        }

        body.light-theme .results-percentage {
            color: #2d3748;
        }

        .options-container {
            display: grid;
            gap: 10px;
        }.option {
            background: #3a3a3a;
            border: 2px solid #666666;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }        .option:hover {
            transform: scale(1.02);
            border-color: #667eea;
            background: #525252;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .option.selected {
            background: #4a5a6a;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.3);
        }

        .option.correct {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
            border-color: #38a169;
            font-weight: 600;
            animation: highlightCorrect 0.5s ease;
        }.option.incorrect {
            background: #5a3a3a;
            border-color: #fc8181;
            color: #ffaaaa;
        }

        @keyframes highlightCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }        .option-letter {
            font-weight: bold;
            margin-right: 10px;
            display: inline-block;
            width: 25px;
            height: 25px;
            background: #667eea;
            color: white;
            text-align: center;
            border-radius: 50%;
            line-height: 25px;
            font-size: 0.9rem;
        }

        .option.correct .option-letter {
            background: #38a169;
        }

        .option.incorrect .option-letter {
            background: #e53e3e;
        }

        .type-indicator {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .type-multiple {
            background: #ed8936;
        }        .loading {
            text-align: center;
            font-size: 1.2rem;
            color: #667eea;
            margin: 50px 0;
        }

        .error {
            background: #5a3a3a;
            color: #ffaaaa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .question-text {
                font-size: 1.1rem;
            }
            
            .database-selector select {
                min-width: 250px;
                font-size: 0.9rem;
            }
            
            .order-btn {
                display: block;
                margin: 10px auto;
                width: 200px;
            }
              .quiz-buttons-container {
                flex-direction: row;
                align-items: center;
                gap: 10px;
                margin: 15px 0 8px 0;
            }
            
            .check-answers-btn,
            .restart-answers-btn {
                width: auto;
                font-size: 0.8rem;
                padding: 8px 16px;
            }
            
            .results-container {
                padding: 20px;
                margin: 20px 0;
            }
            
            .results-score {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>    <div class="container">
        <h1 id="quiz-title">Ładowanie...</h1>
        
        <!-- Database selection dropdown -->
        <div class="database-selector">
            <label for="database-select">Wybierz bazę pytań:</label>
            <select id="database-select" onchange="changeDatabase()">
                <option value="data_awww.json">Quiz Aplikacje WWW</option>
                <option value="data_awww_short.json">Quiz Aplikacje WWW (skrócony)</option>
                <option value="data_roboty.json">Robotyka - Baza Pytań</option>
            </select>
        </div>
          <div class="buttons-container">
            <button class="show-all-answers-btn" onclick="toggleAllAnswers()" id="show-all-btn">
                Pokaż wszystkie odpowiedzi
            </button>            <button class="study-mode-btn" onclick="toggleStudyMode()" id="study-mode-btn">
                Tryb nauki
            </button>
            <button class="theme-toggle-btn" onclick="toggleTheme()" id="theme-toggle-btn">
                🌞 Tryb dzienny
            </button>
        </div>
        
        <div class="order-buttons-container">
            <button class="order-btn original-order" onclick="setOriginalOrder()" id="original-order-btn">
                Kolejność początkowo
            </button>
            <button class="order-btn shuffle-order" onclick="shuffleOrder()" id="shuffle-order-btn">
                Losuj kolejność
            </button>
        </div>
        <div id="questions-container">
            <div class="loading">Ładowanie pytań...</div>
        </div>
    </div>    <!-- Floating buttons in bottom right corner -->
    <div class="floating-buttons">        <!-- Progress counter circle -->
        <div class="progress-counter" id="progress-counter" onclick="scrollToBottom()">
            0/0
        </div>
        <button class="floating-btn" onclick="toggleAllAnswersFloating()" id="floating-show-all-btn">
            ALL
        </button>
        <button class="floating-btn study-mode" onclick="toggleStudyModeFloating()" id="floating-study-mode-btn">
            NAUKA
        </button>
    </div><script>        let quizData = null;
        let currentDatabase = 'data_awww.json'; // domyślna baza danych
        let originalQuestions = null; // przechowuje oryginalne pytania
        let isShuffled = false; // flaga czy pytania są w losowej kolejności
        let userAnswers = {}; // przechowuje odpowiedzi użytkownika
        
        // Funkcja do zmiany bazy danych
        function changeDatabase() {
            const selector = document.getElementById('database-select');
            currentDatabase = selector.value;
            loadQuizData();
        }
        
        // Funkcja do ładowania danych z JSON
        async function loadQuizData() {
            try {
                // Pokazanie komunikatu ładowania
                document.getElementById('questions-container').innerHTML = 
                    '<div class="loading">Ładowanie pytań...</div>';
                
                // Dodanie parametru timestamp aby uniknąć cache'owania
                const timestamp = new Date().getTime();
                const response = await fetch(`${currentDatabase}?v=${timestamp}`);
                if (!response.ok) {
                    throw new Error('Nie można załadować danych');
                }                quizData = await response.json();
                originalQuestions = [...quizData.questions]; // zapisanie kopii oryginalnych pytań
                isShuffled = false; // reset flagi
                displayQuiz();
            } catch (error) {
                console.error('Błąd podczas ładowania danych:', error);
                document.getElementById('questions-container').innerHTML = 
                    `<div class="error">Błąd podczas ładowania pytań. Upewnij się, że plik ${currentDatabase} znajduje się w tym samym folderze.</div>`;
            }
        }        // Funkcja do wyświetlania quizu
        function displayQuiz() {
            if (!quizData) return;

            document.getElementById('quiz-title').textContent = quizData.title || 'Quiz';
            
            // Reset stanu przycisków
            const showAllBtn = document.getElementById('show-all-btn');
            const studyModeBtn = document.getElementById('study-mode-btn');
            showAllBtn.textContent = 'Pokaż wszystkie odpowiedzi';
            showAllBtn.disabled = false;
            showAllBtn.style.opacity = '1';
            studyModeBtn.textContent = 'Tryb nauki';
            
            const container = document.getElementById('questions-container');
            container.innerHTML = '';            // Reset odpowiedzi użytkownika
            userAnswers = {};
            
            // Usuń istniejące wyniki
            const existingResults = document.querySelector('.results-container');
            if (existingResults) {
                existingResults.remove();
            }
            
            // Filtrowanie pytań, które mają treść
            const validQuestions = quizData.questions.filter(q => q.question && q.question.trim() !== '');validQuestions.forEach((question, index) => {
                const questionDiv = createQuestionElement(question, index + 1);
                container.appendChild(questionDiv);
            });
              // Dodanie kontenerów przycisków sprawdzania i restartowania odpowiedzi
            const buttonsContainer = document.createElement('div');
            buttonsContainer.className = 'quiz-buttons-container';
            
            const checkAnswersBtn = document.createElement('button');
            checkAnswersBtn.id = 'check-answers-btn';
            checkAnswersBtn.className = 'check-answers-btn';
            checkAnswersBtn.textContent = 'Sprawdź odpowiedzi';
            checkAnswersBtn.onclick = checkAnswers;
            checkAnswersBtn.disabled = true;
            checkAnswersBtn.style.opacity = '0.5';
            
            const restartAnswersBtn = document.createElement('button');
            restartAnswersBtn.id = 'restart-answers-btn';
            restartAnswersBtn.className = 'restart-answers-btn';
            restartAnswersBtn.textContent = 'Restartuj odpowiedzi';
            restartAnswersBtn.onclick = restartAnswers;
            restartAnswersBtn.disabled = true;
            restartAnswersBtn.style.opacity = '0.5';
            
            buttonsContainer.appendChild(checkAnswersBtn);
            buttonsContainer.appendChild(restartAnswersBtn);
            container.appendChild(buttonsContainer);
            
            // Inicjalizacja licznika na floating przycisku ALL
            updateCheckAnswersButton();
            
            // Aktualizacja stanu przycisków kolejności po wyświetleniu pytań
            updateOrderButtons();
        }
        
        // Funkcja do tasowania tablicy (algorytm Fisher-Yates)
        function shuffleArray(array) {
            const shuffled = [...array]; // kopia tablicy
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // Funkcja do ustawienia oryginalnej kolejności
        function setOriginalOrder() {
            if (!originalQuestions) return;
            
            quizData.questions = [...originalQuestions];
            isShuffled = false;
            displayQuiz();
        }
        
        // Funkcja do losowania kolejności pytań
        function shuffleOrder() {
            if (!originalQuestions) return;
            
            quizData.questions = shuffleArray(originalQuestions);
            isShuffled = true;
            displayQuiz();
        }
          // Funkcja do aktualizacji stanu przycisków kolejności
        function updateOrderButtons() {
            const originalBtn = document.getElementById('original-order-btn');
            const shuffleBtn = document.getElementById('shuffle-order-btn');
            
            if (isShuffled) {
                originalBtn.disabled = false;
                shuffleBtn.disabled = false; // przycisk losuj zawsze aktywny
                originalBtn.style.opacity = '1';
                shuffleBtn.style.opacity = '1'; // zawsze widoczny
            } else {
                originalBtn.disabled = true;
                shuffleBtn.disabled = false;
                originalBtn.style.opacity = '0.5';
                shuffleBtn.style.opacity = '1';
            }
        }

        // Funkcja do tworzenia elementu pytania
        function createQuestionElement(question, questionNumber) {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-container';
            questionDiv.setAttribute('data-question-id', question.id);

            const typeText = question.type === 'multiple' ? 'Wielokrotny wybór' : 'Jeden wybór';
            const typeClass = question.type === 'multiple' ? 'type-multiple' : '';

            questionDiv.innerHTML = `
                <div class="question-number">Pytanie ${questionNumber}</div>
                <div class="type-indicator ${typeClass}">${typeText}</div>
                <div class="question-text">${question.question}</div>
                <button class="show-answer-btn" onclick="showAnswer(${question.id})">Pokaż prawidłową odpowiedź</button>
                <div class="options-container" id="options-${question.id}">
                    ${createOptionsHTML(question)}
                </div>
            `;

            return questionDiv;
        }        // Funkcja do tworzenia HTML dla opcji odpowiedzi
        function createOptionsHTML(question) {
            if (!question.options || question.options.length === 0) {
                return '<div class="option">Brak dostępnych opcji odpowiedzi</div>';
            }

            return question.options.map((option, index) => {
                const letter = String.fromCharCode(65 + index); // A, B, C, D...
                return `
                    <div class="option" data-option-index="${index}" onclick="selectOption(${question.id}, ${index})">
                        <span class="option-letter">${letter}</span>
                        ${option}
                    </div>
                `;            }).join('');
        }

        // Funkcja do wybierania opcji
        function selectOption(questionId, optionIndex) {
            const question = quizData.questions.find(q => q.id === questionId);
            if (!question) return;

            const optionsContainer = document.getElementById(`options-${questionId}`);
            const options = optionsContainer.querySelectorAll('.option');
            
            // Sprawdzenie czy odpowiedzi są już pokazane (nie pozwalamy na wybór)
            if (options[0].classList.contains('correct') || options[0].classList.contains('incorrect')) {
                return;
            }

            if (question.type === 'multiple') {
                // Wielokrotny wybór - toggle selection
                const option = options[optionIndex];
                
                if (!userAnswers[questionId]) {
                    userAnswers[questionId] = [];
                }
                
                const selectedIndex = userAnswers[questionId].indexOf(optionIndex);
                if (selectedIndex > -1) {
                    // Usuń z zaznaczonych
                    userAnswers[questionId].splice(selectedIndex, 1);
                    option.classList.remove('selected');
                } else {
                    // Dodaj do zaznaczonych
                    userAnswers[questionId].push(optionIndex);
                    option.classList.add('selected');
                }            } else {
                // Pojedynczy wybór - toggle selection lub zaznacz nowe
                const option = options[optionIndex];
                
                if (option.classList.contains('selected')) {
                    // Odkliknięcie - usuń zaznaczenie
                    option.classList.remove('selected');
                    delete userAnswers[questionId];
                } else {
                    // Zaznacz nowe - usuń poprzednie zaznaczenie i zaznacz nowe
                    options.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    userAnswers[questionId] = optionIndex;
                }
            }
              // Aktualizuj przycisk sprawdzania odpowiedzi
            updateCheckAnswersButton();
        }        // Funkcja do aktualizacji stanu przycisku sprawdzania odpowiedzi
        function updateCheckAnswersButton() {
            const checkBtn = document.getElementById('check-answers-btn');
            const restartBtn = document.getElementById('restart-answers-btn');
            if (!checkBtn || !restartBtn) return;

            const validQuestions = quizData.questions.filter(q => q.question && q.question.trim() !== '');
            const answeredQuestions = Object.keys(userAnswers).length;
            
            // Aktualizacja przycisku sprawdzania odpowiedzi
            if (answeredQuestions > 0) {
                checkBtn.disabled = false;
                checkBtn.style.opacity = '1';
                restartBtn.disabled = false;
                restartBtn.style.opacity = '1';
            } else {
                checkBtn.disabled = true;
                checkBtn.style.opacity = '0.5';
                restartBtn.disabled = true;
                restartBtn.style.opacity = '0.5';
            }
              // Aktualizacja licznika w kółku nad przyciskiem ALL
            const progressCounter = document.getElementById('progress-counter');
            if (progressCounter) {
                progressCounter.textContent = `${answeredQuestions}/${validQuestions.length}`;
            }
        }// Funkcja do sprawdzania odpowiedzi
        function checkAnswers() {
            const validQuestions = quizData.questions.filter(q => q.question && q.question.trim() !== '');
            let correctAnswers = 0;
            let totalAnswered = 0;

            validQuestions.forEach(question => {
                const questionContainer = document.querySelector(`[data-question-id="${question.id}"]`);
                let isCorrect = false;

                if (userAnswers[question.id] !== undefined) {
                    totalAnswered++;
                    
                    if (question.type === 'multiple') {
                        // Sprawdzanie pytań wielokrotnego wyboru
                        const userAnswer = userAnswers[question.id] || [];
                        const correctAnswer = question.correctAnswers || [];
                        
                        if (Array.isArray(userAnswer) && Array.isArray(correctAnswer)) {
                            userAnswer.sort();
                            correctAnswer.sort();
                            if (JSON.stringify(userAnswer) === JSON.stringify(correctAnswer)) {
                                correctAnswers++;
                                isCorrect = true;
                            }
                        }
                    } else {
                        // Sprawdzanie pytań jednokrotnego wyboru
                        const userAnswer = userAnswers[question.id];
                        const correctAnswer = question.correctAnswer !== undefined ? question.correctAnswer : question.correctAnswers;
                        
                        if (userAnswer === correctAnswer) {
                            correctAnswers++;
                            isCorrect = true;
                        }
                    }

                    // Dodanie wizualnego oznaczenia do kontenera pytania
                    if (questionContainer) {
                        questionContainer.classList.remove('correct-answer', 'incorrect-answer');
                        if (isCorrect) {
                            questionContainer.classList.add('correct-answer');
                        } else {
                            questionContainer.classList.add('incorrect-answer');
                        }
                    }
                } else {
                    // Pytanie bez odpowiedzi - usuń wszystkie klasy oznaczenia
                    if (questionContainer) {
                        questionContainer.classList.remove('correct-answer', 'incorrect-answer');
                    }
                }
            });

            // Wyświetlenie wyników
            displayResults(correctAnswers, totalAnswered, validQuestions.length);
        }

        // Funkcja do wyświetlania wyników
        function displayResults(correct, answered, total) {
            const percentage = answered > 0 ? Math.round((correct / answered) * 100) : 0;
            
            let scoreClass = 'poor';
            let message = 'Potrzebujesz więcej nauki!';
            
            if (percentage >= 80) {
                scoreClass = 'excellent';
                message = 'Świetny wynik!';
            } else if (percentage >= 60) {
                scoreClass = 'good';
                message = 'Dobra robota!';
            }

            const resultsHTML = `
                <div class="results-container">
                    <div class="results-title">Wyniki quizu</div>
                    <div class="results-score ${scoreClass}">${correct}/${answered}</div>
                    <div class="results-details">${message}</div>
                    <div class="results-percentage">${percentage}% poprawnych odpowiedzi</div>
                    ${answered < total ? `<div style="margin-top: 15px; color: #ed8936;">Odpowiedziałeś na ${answered} z ${total} pytań</div>` : ''}
                </div>
            `;            // Dodanie wyników po kontenerze przycisków
            const buttonsContainer = document.querySelector('.quiz-buttons-container');
            const existingResults = document.querySelector('.results-container');
            
            if (existingResults) {
                existingResults.remove();
            }
            
            buttonsContainer.insertAdjacentHTML('afterend', resultsHTML);
        }// Funkcja do pokazywania/ukrywania prawidłowej odpowiedzi
        function showAnswer(questionId) {
            const question = quizData.questions.find(q => q.id === questionId);
            if (!question) return;

            const optionsContainer = document.getElementById(`options-${questionId}`);
            const options = optionsContainer.querySelectorAll('.option');
            const button = optionsContainer.parentElement.querySelector('.show-answer-btn');

            // Sprawdzenie czy odpowiedź jest już pokazana
            const isAnswerShown = options[0].classList.contains('correct') || options[0].classList.contains('incorrect');            if (isAnswerShown) {
                // Ukrywanie odpowiedzi
                options.forEach(option => {
                    option.classList.remove('correct', 'incorrect');
                    // Przywróć zaznaczenia użytkownika
                    const optionIndex = parseInt(option.getAttribute('data-option-index'));
                    if (question.type === 'multiple') {
                        if (userAnswers[questionId] && userAnswers[questionId].includes(optionIndex)) {
                            option.classList.add('selected');
                        }
                    } else {
                        if (userAnswers[questionId] === optionIndex) {
                            option.classList.add('selected');
                        }
                    }
                });
                button.textContent = 'Pokaż prawidłową odpowiedź';
                button.disabled = false;
                button.style.opacity = '1';
            } else {
                // Pokazywanie odpowiedzi - usuń zaznacenia użytkownika
                options.forEach(option => {
                    option.classList.remove('selected');
                });// Pokazywanie odpowiedzi
                if (question.type === 'multiple' && question.correctAnswers) {
                    // Pytanie wielokrotnego wyboru
                    options.forEach((option, index) => {
                        if (question.correctAnswers.includes(index)) {
                            option.classList.add('correct');
                        } else {
                            option.classList.add('incorrect');
                        }
                    });
                } else if (question.type === 'single') {
                    // Pytanie jednokrotnego wyboru - obsługa obu formatów
                    const correctIndex = question.correctAnswer !== undefined ? question.correctAnswer : question.correctAnswers;
                    if (correctIndex !== undefined) {
                        options.forEach((option, index) => {
                            if (index === correctIndex) {
                                option.classList.add('correct');
                            } else {
                                option.classList.add('incorrect');
                            }
                        });
                    }
                }
                button.textContent = 'Ukryj odpowiedź';
                button.disabled = false;
                button.style.opacity = '1';
            }        }

        // Funkcja do pokazywania/ukrywania wszystkich odpowiedzi
        function toggleAllAnswers() {
            if (!quizData) return;

            const validQuestions = quizData.questions.filter(q => q.question && q.question.trim() !== '');
            const showAllBtn = document.getElementById('show-all-btn');
            
            // Sprawdzenie czy wszystkie odpowiedzi są pokazane
            const firstQuestionOptions = document.querySelector('.options-container .option');
            const allAnswersShown = firstQuestionOptions && 
                (firstQuestionOptions.classList.contains('correct') || firstQuestionOptions.classList.contains('incorrect'));

            if (allAnswersShown) {
                // Ukrywanie wszystkich odpowiedzi
                validQuestions.forEach(question => {
                    const optionsContainer = document.getElementById(`options-${question.id}`);
                    if (optionsContainer) {
                        const options = optionsContainer.querySelectorAll('.option');
                        const button = optionsContainer.parentElement.querySelector('.show-answer-btn');
                          options.forEach(option => {
                            option.classList.remove('correct', 'incorrect');
                            // Przywróć zaznaczenia użytkownika
                            const optionIndex = parseInt(option.getAttribute('data-option-index'));
                            if (question.type === 'multiple') {
                                if (userAnswers[question.id] && userAnswers[question.id].includes(optionIndex)) {
                                    option.classList.add('selected');
                                }
                            } else {
                                if (userAnswers[question.id] === optionIndex) {
                                    option.classList.add('selected');
                                }
                            }
                        });
                        
                        if (button) {
                            button.textContent = 'Pokaż prawidłową odpowiedź';
                            button.disabled = false;
                            button.style.opacity = '1';
                        }
                    }
                });
                showAllBtn.textContent = 'Pokaż wszystkie odpowiedzi';            } else {
                // Pokazywanie wszystkich odpowiedzi
                validQuestions.forEach(question => {
                    const optionsContainer = document.getElementById(`options-${question.id}`);
                    if (optionsContainer) {
                        const options = optionsContainer.querySelectorAll('.option');
                        const button = optionsContainer.parentElement.querySelector('.show-answer-btn');
                        
                        // Usuń zaznaczenia użytkownika przy pokazywaniu odpowiedzi
                        options.forEach(option => {
                            option.classList.remove('selected');
                        });
                          if (question.type === 'multiple' && question.correctAnswers) {
                            options.forEach((option, index) => {
                                if (question.correctAnswers.includes(index)) {
                                    option.classList.add('correct');
                                } else {
                                    option.classList.add('incorrect');
                                }
                            });
                        } else if (question.type === 'single') {
                            // Pytanie jednokrotnego wyboru - obsługa obu formatów
                            const correctIndex = question.correctAnswer !== undefined ? question.correctAnswer : question.correctAnswers;
                            if (correctIndex !== undefined) {
                                options.forEach((option, index) => {
                                    if (index === correctIndex) {
                                        option.classList.add('correct');
                                    } else {
                                        option.classList.add('incorrect');
                                    }
                                });
                            }
                        }
                        
                        if (button) {
                            button.textContent = 'Ukryj odpowiedź';
                            button.disabled = false;
                            button.style.opacity = '1';
                        }
                    }
                });
                showAllBtn.textContent = 'Ukryj wszystkie odpowiedzi';
            }        }        // Funkcja do przełączania trybu nauki
        function toggleStudyMode() {
            if (!quizData) return;

            const validQuestions = quizData.questions.filter(q => q.question && q.question.trim() !== '');
            const studyModeBtn = document.getElementById('study-mode-btn');
            const showAllBtn = document.getElementById('show-all-btn');
            
            // Sprawdzenie czy tryb nauki jest aktywny
            const firstButton = document.querySelector('.show-answer-btn');
            const isStudyMode = firstButton && firstButton.classList.contains('hidden');            if (isStudyMode) {
                // Wyłączanie trybu nauki
                validQuestions.forEach(question => {
                    const optionsContainer = document.getElementById(`options-${question.id}`);
                    if (optionsContainer) {
                        const options = optionsContainer.querySelectorAll('.option');
                        const button = optionsContainer.parentElement.querySelector('.show-answer-btn');
                        
                        // Pokaż wszystkie opcje i usuń style odpowiedzi
                        options.forEach(option => {
                            option.classList.remove('hidden', 'correct', 'incorrect');
                        });
                        
                        // Pokaż przycisk "Pokaż prawidłową odpowiedź"
                        if (button) {
                            button.classList.remove('hidden');
                        }
                    }
                });
                
                studyModeBtn.textContent = 'Tryb nauki';
                showAllBtn.disabled = false;
                showAllBtn.style.opacity = '1';
                
                // Pokaż przyciski sprawdzania i restartowania odpowiedzi
                const buttonsContainer = document.querySelector('.quiz-buttons-container');
                if (buttonsContainer) {
                    buttonsContainer.style.display = 'flex';
                }
            } else {
                // Włączanie trybu nauki
                validQuestions.forEach(question => {
                    const optionsContainer = document.getElementById(`options-${question.id}`);
                    if (optionsContainer) {
                        const options = optionsContainer.querySelectorAll('.option');
                        const button = optionsContainer.parentElement.querySelector('.show-answer-btn');
                        
                        // Ukryj przycisk "Pokaż prawidłową odpowiedź" w trybie nauki
                        if (button) {
                            button.classList.add('hidden');
                        }
                        
                        // Ukryj wszystkie opcje oprócz prawidłowych
                        if (question.type === 'multiple' && question.correctAnswers) {
                            options.forEach((option, index) => {
                                if (question.correctAnswers.includes(index)) {
                                    option.classList.add('correct');
                                    option.classList.remove('hidden');
                                } else {
                                    option.classList.add('hidden');
                                }
                            });
                        } else if (question.type === 'single') {
                            // Pytanie jednokrotnego wyboru - obsługa obu formatów
                            const correctIndex = question.correctAnswer !== undefined ? question.correctAnswer : question.correctAnswers;
                            if (correctIndex !== undefined) {
                                options.forEach((option, index) => {
                                    if (index === correctIndex) {
                                        option.classList.add('correct');
                                        option.classList.remove('hidden');
                                    } else {
                                        option.classList.add('hidden');
                                    }
                                });
                            }
                        }
                    }
                });
                  
                studyModeBtn.textContent = 'Wyłącz tryb nauki';
                showAllBtn.disabled = true;
                showAllBtn.style.opacity = '0.5';
                  
                // Ukryj przyciski sprawdzania i restartowania odpowiedzi w trybie nauki
                const buttonsContainer = document.querySelector('.quiz-buttons-container');
                if (buttonsContainer) {
                    buttonsContainer.style.display = 'none';
                }
            }
        }        // Funkcja do restartowania odpowiedzi
        function restartAnswers() {
            // Wyczyść wszystkie odpowiedzi użytkownika
            userAnswers = {};
            
            // Usuń wszystkie zaznaczenia i wizualne oznaczenia
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Usuń oznaczenia poprawności z kontenerów pytań
            document.querySelectorAll('.question-container').forEach(container => {
                container.classList.remove('correct-answer', 'incorrect-answer');
            });
            
            // Usuń wyniki
            const resultsContainer = document.querySelector('.results-container');
            if (resultsContainer) {
                resultsContainer.remove();
            }
            
            // Aktualizuj przyciski
            updateCheckAnswersButton();
        }// Funkcje dla floating buttons (zsynchronizowane z głównymi przyciskami)
        function toggleAllAnswersFloating() {
            toggleAllAnswers();
            // Tekst pozostaje stały - "ALL"
        }

        function toggleStudyModeFloating() {
            toggleStudyMode();
            // Tekst pozostaje stały - "NAUKA"
            
            // Synchronizacja stanu disabled
            const showAllFloating = document.getElementById('floating-show-all-btn');
            const showAllMain = document.getElementById('show-all-btn');
            showAllFloating.disabled = showAllMain.disabled;
        }        // Ładowanie danych po załadowaniu strony
        document.addEventListener('DOMContentLoaded', function() {
            loadQuizData();
            initializeTheme();
        });

        // Funkcja do inicjalizacji motywu
        function initializeTheme() {
            const savedTheme = localStorage.getItem('quizTheme') || 'dark';
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                document.getElementById('theme-toggle-btn').innerHTML = '🌙 Tryb nocny';
            } else {
                document.body.classList.remove('light-theme');
                document.getElementById('theme-toggle-btn').innerHTML = '🌞 Tryb dzienny';
            }
        }        // Funkcja do przełączania motywu
        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.getElementById('theme-toggle-btn');
            
            if (body.classList.contains('light-theme')) {
                // Przełączenie na tryb nocny
                body.classList.remove('light-theme');
                themeBtn.innerHTML = '🌞 Tryb dzienny';
                localStorage.setItem('quizTheme', 'dark');
            } else {
                // Przełączenie na tryb dzienny
                body.classList.add('light-theme');
                themeBtn.innerHTML = '🌙 Tryb nocny';
                localStorage.setItem('quizTheme', 'light');
            }
        }

        // Funkcja do przewijania na dół strony
        function scrollToBottom() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>